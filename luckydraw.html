<html>
<head>

<title>抽奖</title>
<script language="javascript">
// global variables 
var timer;
var flag = new Array(100);
var existingnum = new Array(100);
var clickTimes = 0;
var randnum;
var cellnum =1;
var mobile = new Array();

// set data here!!
mobile.push(new Array("大法师的方法", 100));
mobile.push(new Array("偶偶偶人", 100));
mobile.push(new Array("大法师的方法", 100));
mobile.push(new Array("偶偶偶人", 100));
mobile.push(new Array("大法师的方法", 100));
mobile.push(new Array("偶偶偶人", 100));
mobile.push(new Array("大法师的方法", 100));
mobile.push(new Array("偶偶偶人", 100));
mobile.push(new Array("大法师的方法", 100));
mobile.push(new Array("偶偶偶人", 100));
mobile.push(new Array("大法师的方法", 100));
mobile.push(new Array("偶偶偶人", 100));
mobile.push(new Array("大法师的方法", 100));
mobile.push(new Array("偶偶偶人", 100));


var num = mobile.length;

function getRandNum() {
	document.getElementById("result").value = mobile[genRandom(0, num)][0];
}

function selectName() {
	var i;
	var s = 0;
	for (i = 0; i < num; i += 1) {
		s += mobile[i][1];
	}

	idx = genRandom(0, s) + 1;
	s = 0;
	for (i = 0; i < num; i += 1) {
		s += mobile[i][1];
		if (s >= idx) {
			return mobile[i][0];
		}
	}
	return -1;
}

//生成一个随机数，取值范围[min, max)
function genRandom(min, max){	 
	randnum = parseInt(Math.random() * 1000000000) % (max - min) + min;
	return randnum;
}

function setTimer() {
	timer = setInterval("getRandNum();", 10);
	document.getElementById("start").disabled = true;
	document.getElementById("end").disabled = false;
}

//点击'停'按钮
function clearTimer(){
	// noDupNum();
	//clearInterval(对象) 清除已设置的setInterval对象 javascript事件, 
	//timer是一个setInterval事件
	clearInterval(timer);
	//按钮状态改换
	document.getElementById("start").disabled = false;
	document.getElementById("end").disabled = true;

	finalName = selectName()
	document.getElementById("result").value = finalName

	removeName(finalName)
}

 //进行 停止的 初始化操作  1 实现从数组里面把已经获奖的人员电话号码删除 2 修改数组长度
function removeName(name) {
	var i;
	var idx;
	for (i = 0; i < num; i += 1) {
		if (mobile[i][0] == name) {
			idx = i;
			break;
		}
	}

	for (i = idx; i < num - 1; i += 1) {
		mobile[i][0] = mobile[i + 1][0];
		mobile[i][1] = mobile[i + 1][1];
	}

	num -= 1;

	for (i = 0; i < num; i += 1) {
		console.log(mobile[i])
	}
}

</script>
</head>
	<body>
		<center>

		<div id="Layer1" style="position:absolute; width:99%; height:95%; z-index:-1">  
		<img src="back.png" height="100%" width="100%" style="opacity:0.8;"/>  
		</div>  

		<div id="main" style="position:absolute;width:1000px;height:500px;left:50%;top:50%;margin-left:-500px;margin-top:-150px;z-index:99;">
			<div>
				<p>
				<input id="result" type="text" size="30" style="height:130px;width:900px;border:2px solid black;font-size:120;text-align: center" readonly/></p>
				<p>
				<input id="start" type="button" value="Start" style="border: 2px solid; border-color: #aaa 000 #000 #aaa; width:6em; height: 2em; font-size: 40; background: #fc0;" onclick="setTimer()" />
				<input id="end" type="button" value="Stop" style="border: 1px solid; border-color: #aaa 000 #000 #aaa;width:4em; width:6em; height: 2em; font-size: 40; background: #fc0;"onclick="clearTimer();" disabled/>
				</p>

				<p> </p>
				<p> </p>
				<p> </p>
			</div>
		</div>
		<center>
	</body>
</html>